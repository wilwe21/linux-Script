#!/usr/bin/env python3
import random, sys, os, argparse
parser = argparse.ArgumentParser()
parser.add_argument("-l", "--language", help="Translate Language")
parser.add_argument("-f", "--file", help="Specyfy file")
parser.add_argument("-p", "--path", help="Specyfy path")
parser.add_argument("-ol", "--oryginalang", help="Specyfy oryginal file language", default="en")
parser.add_argument("-ls", "--list", help="List files", action=argparse.BooleanOptionalAction)
parser.add_argument("-v", "--voice", help="Hear output", action=argparse.BooleanOptionalAction)
parser.add_argument("-tv", "--tvoice", help="Hear translated output", action=argparse.BooleanOptionalAction)
args = parser.parse_args()
path = '/home/wilwe/Dokumenty/oryginaÅ‚/Lyrics'
if args.path != None:
    path = args.path
lis = os.popen('ls ' + path).readlines()
if args.list:
    if args.path != None:
        print(f"Path {path}")
    else:
        print(f"Default Path {path}")
    lis = list(map(str.strip, lis))
    print(' | '.join(lis))
    sys.exit()
file = lis[random.randrange(len(lis))]
file = file.strip('\n')
while os.path.isdir(f"{path}/{file}"):
    file = lis[random.randrange(len(lis))]
    file = file.strip('\n')
if args.file != None:
    file = args.file
print(f'\033[38;2;203;166;247mðŸ­ƒ\033[0m\033[48;2;203;166;247m\033[38;2;24;24;37m{file}\033[0m\033[38;2;203;166;247mðŸ­Ÿ\033[0m')
print('--------------------------')
if open(f"{path}/{file}").readline() == '':
    sys.exit()
lin = open(f"{path}/{file}").readlines()
line = random.randrange(len(lin))
while lin[line].strip('\n') == '':
    line += 1
print(lin[line].strip('\n'))
next = line+1
if next < len(lin):
    while lin[next].strip('\n') == '':
        if next+1 < len(lin):
            next += 1
        else: 
            break
o1 = lin[line].strip('\n').strip('"')
if next < len(lin):
    print(lin[next].strip('\n'))
    o2 = lin[next].strip('\n').strip('"')
    if args.voice and not args.tvoice:
        os.popen(f'tts -m -l {args.oryginalang} -s "{o1}" && tts -m -l {args.oryginalang} -s "{o2}"')
else:
    if args.voice and not args.tvoice:
        os.popen(f'tts -m -l {args.oryginalang} -s "{o1}"')
if args.language != None:
    print("")
    print(f'\033[38;2;203;166;247mðŸ­ƒ\033[0m\033[48;2;203;166;247m\033[38;2;24;24;37m{args.language}\033[0m\033[38;2;203;166;247mðŸ­Ÿ\033[0m')
    print('--------------------------')
    t1 = os.popen("trans -t " + args.language + " -j -brief -show-original n -show-translation Y -show-original-phonetics n -show-translation-phonetics n -show-languages n -show-dictionary n -show-alternatives n -no-ansi -no-autocorrect " + '"' + o1 + '"').read()
    print(t1)
    print("\033[2A")
    if next < len(lin):
        t2 = os.popen("trans -t " + args.language + " -j -brief -show-original n -show-translation Y -show-original-phonetics n -show-translation-phonetics n -show-languages n -show-dictionary n -show-alternatives n -no-ansi -no-autocorrect " + '"' + o2 + '"').read()
        print(t2)
        if args.tvoice and not args.voice:
            os.popen(f'tts -m -l {args.language} -s "{t1}" && tts -m -l {args.language} -s "{t2}"')
    else:
        if args.tvoice and not args.voice:
            os.popen(f'tts -m -l {args.language} -s "{t1}"')
if args.voice and args.tvoice and args.language != None:
    if next < len(lin):
        os.popen(f'tts -m -l {args.oryginalang} -s "{o1}" && tts -m -l {args.oryginalang} -s "{o2}" && tts -m -l {args.language} -s "{t1}" && tts -m -l {args.language} -s "{t2}"')
    else:
        os.popen(f'tts -m -l {args.oryginalang} -s "{o1}" && tts -m -l {args.language} -s "{t1}""')
elif args.voice and args.tvoice and args.language == None:
    if next < len(lin):
        os.popen(f'tts -m -l {args.oryginalang} -s "{o1}" && tts -m -l {args.oryginalang} -s "{o2}"')
    else:
        os.popen(f'tts -m -l {args.oryginalang} -s "{o1}"')
