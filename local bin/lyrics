#!/usr/bin/env python3
import lyricsgenius, yaml, os
from pathlib import Path
with open(f"{Path.home()}/.config/lyrics.yaml", "r") as f:
    data = yaml.load(f,Loader=yaml.FullLoader)
token = data["token"]
genius = lyricsgenius.Genius(token, verbose=False)
artist = genius.search_artist(input("Artist: "),get_full_info=False,per_page=0, max_songs=0)
song = input("What a Song: ")
try:
    artist.song(song).save_lyrics(extension="TXT", filename=song)
except:
    print("No song finde or check internet connection")
    exit()
song = song.replace("'","").replace('"',"")
fins = []
f2 = []
with open(f"{song}.txt") as f:
    file = f.read().split("\n")
    oline = file[0]
    oline = oline.replace(oline[:oline.find("Lyrics")+6], "")
    file[0] = oline
    file[-1] = file[-1][:file[-1].find("Embed")]
    for line in range(len(file)):
        if file[line].find("’") != -1:
            file[line] = file[line].replace("’","'")
        if file[line].find('“') != -1:
            file[line] = file[line].replace('“','"')
        if file[line].find("‘") != -1:
            file[line] = file[line].replace("‘","'")
        if file[line].find('”') != -1:
            file[line] = file[line].replace('”','"')
        if file[line].find("You might also like") != -1:
            file[line] = file[line].replace(file[line][:oline.find("You might also like")], "")
        if file[line].find("]") != -1:
            file[line] = file[line].replace(file[line][:file[line].find("]")+1],"")
        if file[line] == "—":
            continue
        f2.append(file[line])
    if f2[0] == "":
        f2.remove(f2[0])
    for line in range(len(f2)):
        try:
            if len(f2[line]) == 0 and len(f2[line+1]) == 0:
                continue
        except:
            pass
        fins.append(f2[line])
with open(f"{song}", "w+") as fin:
    fin.write('\n'.join(fins))
os.remove(f"{song}.txt")
